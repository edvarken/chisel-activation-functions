import matplotlib.pyplot as plt
import numpy as np

def visualize_errors(max_value, n_points, errors1, errors2, make_absolute=True):
    plot = plt.figure(figsize=(12, 4)) 
    plt.rcParams["font.family"] = "Times New Roman"
    # plt.title("Absolute errors Linear Activation Function Errors", fontsize=18)

    # Generate x values for the plot
    x_values = np.linspace(-max_value, max_value, n_points+1)  # 101 points from -8 to 8 inclusive or -6 to 6 inclusive
    plt.xlim([-max_value, max_value])

    if make_absolute:
        # Convert errors to absolute values
        errors1 = np.abs(errors1)
        errors2 = np.abs(errors2)
    
    siluAAE = sum(np.abs(errors1)) / len(errors1)
    geluAAE = sum(np.abs(errors2)) / len(errors2)

    colors = ['k', 'grey']
    # Plot the Errors
    plt.plot(x_values, errors1, label='SiLU approx. errors using 20 non-uniform 1st order segments for sigmoid', linestyle='-', color=colors[0])
    plt.plot(x_values, errors2, label='GELU approx. errors using 20 non-uniform 1st order segments for sigmoid', linestyle='-', color=colors[1])

    #plot the average absolute errors as a horizontal line
    plt.axhline(y=siluAAE, color=colors[0], linestyle='--', label='SiLU Average Absolute Error (AAE)')
    plt.axhline(y=geluAAE, color=colors[1], linestyle='--', label='GELU Average Absolute Error (AAE)')

    # Add labels and title
    plt.xlabel('Input Range (x)', fontdict={'size': 13})
    plt.ylabel('Absolute Error', fontdict={'size': 13})
    # if make_absolute:
    #     plt.title('Absolute SiLU Errors for x*sigmoid(x) where sigmoid is approximated using 18 versus 20 PWL segments')
    # else:
    #     plt.title('SiLU Errors for x*sigmoid(x) where sigmoid is approximated using 18 versus 20 PWL segments')
    plt.legend()
    plt.tight_layout()
    # Show the plot
    plt.show()

if __name__ == "__main__":
    siluPWLSigmoid18SegmentsErrors = [-0.002682801, -0.0031600117, -0.0036202918, -0.0041458397, -0.0047455556, -0.005429478, -0.006208916, -0.007096588, -0.008106775, -0.009503379, -0.010842105, -0.012361471, -0.014084172, 0.030107195, 0.026678948, 0.022963727, 0.018927926, 0.013609964, 0.008735465, 0.0034121647, 0.034947217, 0.027363922, 0.019185446, 0.010359395, 8.33109E-4, 0.02180516, 0.008353107, 0.02369035, 0.03619603, 0.018019632, 0.023065269, 0.003037855, 0.026152924, 0.023180917, 0.014222145, 0.004527673, 0.0104855, 0.011990935, 0.007901102, 0.0032069087, 0.004321724, 0.005346626, 0.010600716, 0.0038729012, 0.0039809346, 0.0014388561, 0.0033353567, 5.123764E-4, 0.0026653707, -2.6457012E-5, 2.3874236E-12, -2.6457012E-5, 0.0016888082, 5.123913E-4, 4.056692E-4, 0.0024154186, 0.0039809346, 0.001919806, 0.006694436, -0.0024658442, -0.0034908056, -6.994009E-4, 0.0118073225, 0.0032018423, 0.0026729107, 0.0025744438, 0.002503395, 0.019274712, 0.01834035, 0.0010848045, 0.014276266, 0.012160301, 0.02350068, 0.018319368, 0.012259245, 0.0053532124, -0.0016083717, 0.0054764748, 0.011861324, 0.017598152, 0.022740364, -0.003911972, 1.9073486E-4, 0.0038442612, 0.0076975822, 0.010512352, 0.013007164, 0.015214443, -0.014084339, -0.0123615265, -0.010842323, -0.009503365, -0.0081067085, -0.0070967674, -0.0062088966, -0.005429268, -0.0047454834, -0.0041456223, -0.0036201477, -0.0031599998, -0.0027570724]
    siluPWLSigmoid20SegmentsErrors = [-0.002682801, -0.0031600117, -0.0036202918, -0.0041458397, -0.0047455556, -0.005429478, -0.006208916, -0.007096588, -0.008106775, -0.009503379, -0.010842105, -0.012361471, -0.014084172, 0.030107195, 0.026678948, 0.022963727, 0.018927926, 0.013609964, 0.008735465, 0.041986383, 0.034947217, 0.027363922, 0.019185446, 0.010359395, 0.033547953, 0.02180516, 0.008353107, 0.02369035, 0.03619603, 0.018019632, 0.023065269, 0.003037855, 0.026152924, 0.023180917, 0.014222145, 0.004527673, 0.0104855, 0.011990935, 0.007901102, 0.0032069087, 0.004321724, 0.005346626, 0.010600716, 0.0038729012, 0.0039809346, 0.0014388561, 0.0033353567, 5.123764E-4, 0.0026653707, -2.6457012E-5, 2.3874236E-12, -2.6457012E-5, 0.0016888082, 5.123913E-4, 4.056692E-4, 0.0024154186, 0.0039809346, 0.001919806, 0.006694436, -0.0024658442, -0.0034908056, -6.994009E-4, 0.0118073225, 0.0032018423, 0.0026729107, 0.0025744438, 0.002503395, 0.019274712, 0.01834035, 0.0010848045, 0.014276266, 0.012160301, 0.02350068, 0.018319368, 0.012259245, 0.0053532124, 0.029641628, 0.0054764748, 0.011861324, 0.017598152, 0.022740364, 0.027338028, 1.9073486E-4, 0.0038442612, 0.0076975822, 0.010512352, 0.013007164, 0.015214443, -0.014084339, -0.0123615265, -0.010842323, -0.009503365, -0.0081067085, -0.0070967674, -0.0062088966, -0.005429268, -0.0047454834, -0.0041456223, -0.0036201477, -0.0031599998, -0.0027570724]
    # visualize_errors(siluPWLSigmoid18SegmentsErrors, siluPWLSigmoid20SegmentsErrors, make_absolute=True)

    siluPWLSigmoid20SegmentsWithExtraInterceptsErrors6to6 = [-0.014835739, 7.564686E-4, 6.7797117E-4, 4.1586906E-4, -1.6896054E-4, 0.0014686659, 7.925816E-4, 7.268544E-4, 5.5901706E-4, -1.5179068E-4, 3.5107136E-5, 6.0622394E-4, -6.61768E-4, 0.0023370124, 0.004011739, 0.0027968884, 0.002572231, 0.0026987195, 0.008353107, 0.010049313, 0.012720548, 0.013845496, 0.011671975, 0.010254182, 0.0068091005, 0.0012770742, 0.0036919862, 0.0037070215, 0.0043305606, 0.001359731, 6.214231E-4, 0.0038050562, 0.0038310885, 0.006642297, 0.0039948523, 2.8643012E-4, 0.0016841888, 0.0022840202, 0.001440376, 9.5656514E-4, -3.3947825E-4, -2.5638938E-4, 0.0020278096, -0.001316607, 8.1653893E-4, 7.943213E-4, 5.123764E-4, -2.8203428E-4, 8.303672E-5, 3.9967895E-4, 3.4106051E-12, 3.9967895E-4, 0.0010596067, -2.8203428E-4, 5.123913E-4, 7.943213E-4, 8.16524E-4, 0.004542768, 0.0039809346, -2.5641918E-4, 0.0035668015, 0.0029096603, -0.0024658442, 0.00228405, 0.0016841888, 0.002239585, 0.0118073225, 0.0066423416, 0.0028544664, 0.0057582855, 0.0025744438, 0.015031576, 0.01019001, 0.0066366196, 0.01834035, 0.012591839, 0.0077855587, 0.018066645, 0.012160301, 0.0201931, 0.013208866, 0.021279812, 0.012259245, 0.0036752224, 0.009408236, -1.3303757E-4, 0.0054764748, 0.01063776, 0.014230728, 0.018672466, 0.022740364, 0.026459694, -0.0013942719, 0.0017032623, 0.0038442612, 0.0064735413, 0.008864403, 0.011035919, 0.013007164, 0.01479435, 0.016024113]
    geluPWLSigmoid20SegmentsWithExtraInterceptsErrors6to6 = [-8.439649E-11, -2.591234E-10, -7.645818E-10, -2.1698567E-9, -5.92764E-9, -1.5600177E-8, -3.9584638E-8, -7.773818E-8, -1.8541259E-7, -4.2732574E-7, -9.5245207E-7, -2.0546584E-6, -4.293342E-6, -7.310757E-6, -1.44752985E-5, -2.7822634E-5, -5.1953517E-5, -8.767931E-5, -1.5541173E-4, -2.508869E-4, -4.2325404E-4, 0.009069409, 0.010419955, 0.011342766, 0.014177851, 0.014673155, 0.015760895, 0.01778955, 0.019857807, 0.022364717, 0.022279745,0.024504121, 0.027775329, 0.02657155, 0.023461983, 0.017444476, 0.014996409, 0.012946494, 0.006778784, 0.0034362748, 0.0037302673, -0.0022299588,-0.004913166, -0.0063744783, -0.0057287365, -0.004252419, -0.004809007, -0.003280282, -0.0017939508, 8.040294E-5, 5.456968E-12, 8.0406666E-5, -0.0013056695, -0.003280282, -0.0028558671, -0.004252434, -0.0057287216, -0.008327603, -0.0058897138, 6.9975853E-4, 0.009589672, 5.066395E-4, 0.008731961, 0.015876174, 0.02329719, 0.02086246, 0.03273928, 0.027548075, 0.029240131, 0.020597935, 0.027162552, 0.032374382, 0.020346165, 0.023526907, 0.025892735, 0.011802673, 0.013079166, 0.029592276, 0.030195236, 0.030553818, -4.2319298E-4, -2.5081635E-4, -1.5544891E-4, -8.773804E-5, -5.197525E-5, -2.7656555E-5, -1.4305115E-5, -7.1525574E-6, -4.2915344E-6, -1.9073486E-6, -9.536743E-7, -4.7683716E-7, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    # visualize_errors(6.0, 100, siluPWLSigmoid20SegmentsWithExtraInterceptsErrors6to6, geluPWLSigmoid20SegmentsWithExtraInterceptsErrors6to6, make_absolute=True)

    siluPWLSigmoid20SegmentsWithExtraInterceptsErrors8to8 = [-0.002682801, -0.0031600117, -0.0036202918, -0.0041458397, -0.0047455556, -0.005429478, -0.006208916, -0.007096588, -0.008106775, -0.009503379, -0.010842105, -0.012361471, -0.014084172, 5.6617893E-4, 6.7797117E-4, 3.8071908E-4, 3.732387E-4, 7.925816E-4, 0.0011671055, -2.4994463E-4, 3.5107136E-5, 2.6431307E-4, 0.0018514618, 0.004011739, 0.002786234, 0.0022739097, 0.008353107, 0.012948163, 0.011781968, 0.011671975, 0.007440269, 0.003037855, 0.0036919862, 0.0046262294, 0.0015268326, 6.214231E-4, 0.0016964376, 0.0041784346, 0.0039948523, -6.993413E-4, -0.0015376508, 0.001440376, 0.0027882159, 0.0019197762, 0.0020278096, -5.142689E-4, 0.0013822317, 5.123764E-4, 7.122457E-4, -2.6457012E-5, 2.3874236E-12, -2.6457012E-5, 0.0016888082, 5.123913E-4, 4.056692E-4, 0.0024154186, 0.0039809346, 0.001919806, 0.006694436, -0.0024658442, -0.0034908056, -6.994009E-4, 0.0118073225, 0.0032018423, 0.0026729107, 0.0025744438, 0.002503395, 0.019274712, 0.01834035, 0.0010848045, 0.014276266, 0.012160301, 0.02350068, 0.018319368, 0.012259245, 0.0053532124, 0.029641628, 0.0054764748, 0.011861324, 0.017598152, 0.022740364, 0.027338028, 1.9073486E-4, 0.0038442612, 0.0076975822,0.010512352, 0.013007164, 0.015214443, -0.014084339, -0.0123615265, -0.010842323, -0.009503365, -0.0081067085, -0.0070967674, -0.0062088966, -0.005429268, -0.0047454834, -0.0041456223, -0.0036201477, -0.0031599998, -0.0027570724]
    geluPWLSigmoid20SegmentsWithExtraInterceptsErrors8to8 = [0.0, 0.0, 0.0, 0.0, 0.0, -3.989864E-16, -1.5612511E-15, -9.922618E-15, -5.930152E-14, -4.5174628E-13, -2.2783025E-12, -1.07432795E-11, -4.744052E-11, -1.9649142E-10, -7.645818E-10, -2.7995106E-9, -9.660709E-9, -3.9584638E-8, -1.2057833E-7, -3.4792086E-7, -9.5245207E-7, -2.4776366E-6, -6.133964E-6, -1.44752985E-5, -3.2611148E-5, -7.024595E-5, -1.5541173E-4, -3.0616554E-4, -5.79371E-4, 0.010419955, 0.012085794, 0.014531718, 0.015760895, 0.01817639, 0.021524746, 0.022279745, 0.024340685, 0.02788971, 0.023461983, 0.01464884, 0.012440637, 0.006778784, 0.002442181, -0.0011279732, -0.004913166, -0.0065416396, -0.0048493743, -0.004809007, -0.0027224943, -6.764531E-4, 3.8653525E-12, -6.764531E-4, -0.0022342205, -0.0028558671, -0.0048493743, -0.005565107, -0.0058897138, 8.251667E-4, 0.0034188032, 0.008731961, 0.020741463, 0.01660192, 0.03273928, 0.039120197, 0.018725395, 0.027162552, 0.03348756, 0.02281499, 0.025892735, 0.027959347, 0.01367259, 0.030195236, -5.7935715E-4, -3.0612946E-4, -1.5544891E-4, -7.557869E-5, -3.2424927E-5, -1.4305115E-5, -6.198883E-6, -2.3841858E-6, -9.536743E-7, -4.7683716E-7, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    # visualize_errors(8.0, 100, siluPWLSigmoid20SegmentsWithExtraInterceptsErrors8to8, geluPWLSigmoid20SegmentsWithExtraInterceptsErrors8to8, make_absolute=True)


    siluPWLSigmoid20NonUniformSegmentsErrorsMax8 = [-0.002682801, -0.0031600117, -0.0036202918, -0.0041458397, -0.0047455556, -0.005429478, -0.006208916, -0.007096588, -0.008106775, -0.009503379, -0.010842105, -0.012361471, -0.014084172, 0.0070359055, 0.00421801, 0.001113141, -0.0023123082, -0.006897848, 0.0011671055, 0.0034121647, -0.002406299, 2.6431307E-4, 0.0038045868, 0.005964864, 0.006692484, 0.0061801597, 0.0044468567, 0.005623944, 0.008363999, 0.008742288, 0.0045105815, -8.6839497E-4, -0.0021673888, -0.0031862706, -0.00335598, 6.214231E-4, -0.0022098124, 0.0041784346, 0.007901102, 0.009066284, 0.004321724, 0.005346626, 0.004741341, 0.0038729012, 0.0020278096, 0.0024154186, 0.0023587942, 0.0014889389, 0.0016888082, 9.501055E-4, 2.3874236E-12, 9.501055E-4, 0.0016888082, 0.0024655163, 0.004311919, 0.0063216686, 0.0039809346, 0.001919806, 0.006694436, 0.005346656, 0.0043216944, 0.007113099, 0.0118073225, 0.0032018423, 0.0026729107, 0.0025744438, 0.002503395, 0.0036497116, 0.0027153492, 0.0010848045, 0.014276266, 0.012160301, 0.007875681, 0.0026943684, 0.012259245, 0.020978212, 0.029641628, 0.0054764748, 0.011861324, 0.017598152, -0.008509636, -0.003911972, 1.9073486E-4, 0.0038442612, 0.0076975822, 0.010512352, 0.013007164, 0.015214443, -0.014084339, -0.0123615265, -0.010842323, -0.009503365, -0.0081067085, -0.0070967674, -0.0062088966, -0.005429268, -0.0047454834, -0.0041456223, -0.0036201477, -0.0031599998, -0.0027570724]
    geluPWLSigmoid20NonUniformSegmentsErrorsMax8 = [0.0, 0.0, 0.0, 0.0, 0.0, -3.989864E-16, -1.5612511E-15, -9.922618E-15, -5.930152E-14, -4.5174628E-13, -2.2783025E-12, -1.07432795E-11, -4.744052E-11, -1.9649142E-10, -7.645818E-10, -2.7995106E-9, -9.660709E-9, -3.9584638E-8, -1.2057833E-7, -3.4792086E-7, -9.5245207E-7, -2.4776366E-6, -6.133964E-6, -1.44752985E-5, -3.2611148E-5, -7.024595E-5, -1.5541173E-4, -3.0616554E-4, -5.79371E-4, 0.012067904, 0.0104988795, 0.012944804, 0.017103668, 0.01817639, 0.02274545, 0.024721151, 0.02214342, 0.02398346, 0.021508858, 0.013183996, 0.0080461055, 0.0038490966, 0.002442181, 8.251518E-4, -0.0010069162, -0.0026353896, -0.0038728118, -0.002855882, -0.0012576506, 3.001094E-4, 3.8653525E-12, 3.001094E-4, -0.001257658, -9.0274215E-4, -0.0028962493, -0.0016588569, -0.0019834638, 8.251667E-4, 0.0034188032, 9.1946125E-4, 0.012928963, 0.01660192, 0.024926782, 0.023495197, 0.018725395, 0.027162552, 0.03348756, 0.02281499, 0.0102677345, 0.027959347, 0.01367259, 0.014570236, -5.7935715E-4, -3.0612946E-4, -1.5544891E-4, -7.557869E-5, -3.2424927E-5, -1.4305115E-5, -6.198883E-6, -2.3841858E-6, -9.536743E-7, -4.7683716E-7, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    # visualize_errors(8.0, 100, siluPWLSigmoid20NonUniformSegmentsErrorsMax8, geluPWLSigmoid20NonUniformSegmentsErrorsMax8, make_absolute=True)
    siluPWLSigmoid20NonUniformSegmentsErrorsMax6 = [-0.014835739, 0.0064937733, 0.00421801, 0.0017586425, -9.013824E-4, -0.0037803575, -0.006897848, -0.0018366221, 0.0042211264, 0.0022896156, -0.002406299, -6.144792E-4, 0.00251206, 0.004534278, 0.005964864, 0.0067031384, 0.006478481, 0.0066049695, 0.0044468567, 0.0027250946, 0.005396329, 0.0070095584, 0.008742288, 0.0073244944, 0.003879413,-0.0016526133, -0.0021673888, -0.0041054785, -0.002505377, -0.0035230815, 6.214231E-4, -1.01193786E-4, -7.516146E-5, 0.002736047, 0.007901102, 0.00809893, 0.007543564, 0.004237145, 0.005346626, 0.00681594, 0.0055198967, 0.0016967356, 0.0020278096, 0.002589643, 0.002769664, 0.0017708838, 0.0014889389, 6.945282E-4, 0.0010595992, 3.9967895E-4, 3.4106051E-12, 3.9967895E-4, 0.0010596067, 6.945282E-4, 0.0024655163, 0.0027474463, 0.002769649, 0.004542768, 0.0039809346, 0.0036498308, 0.0074730515, 0.01072216, 0.005346656, 0.01009655, 0.009496689, 0.010052085, 0.0118073225, -0.0011701584, 0.0028544664, 0.0057582855, 0.0025744438, -5.9342384E-4, -0.00543499, -0.00898838, 0.0027153492,0.012591839, 0.0077855587, 0.018066645, 0.012160301, 0.0201931, 0.013208866, 0.021279812, 0.012259245, 0.019300222, 0.009408236, 0.031116962, 0.0054764748, 0.01063776, 0.014230728, 0.018672466, -0.008509636, -0.004790306, -0.0013942719, 0.0017032623, 0.0038442612, 0.0064735413, 0.008864403, 0.011035919, 0.013007164, 0.01479435, 0.016024113]
    geluPWLSigmoid20NonUniformSegmentsErrorsMax6 = [-8.439649E-11, -2.591234E-10, -7.645818E-10, -2.1698567E-9, -5.92764E-9, -1.5600177E-8, -3.9584638E-8, -7.773818E-8, -1.8541259E-7, -4.2732574E-7, -9.5245207E-7, -2.0546584E-6, -4.293342E-6, -7.310757E-6, -1.44752985E-5, -2.7822634E-5, -5.1953517E-5, -8.767931E-5, -1.5541173E-4, -2.508869E-4, -4.2325404E-4, 0.012853589, 0.012067904, 0.010976555, 0.009600215, 0.013940733, 0.017103668, 0.016446777, 0.02107851, 0.02358542, 0.024721151, 0.023527559, 0.023624938, 0.024618424, 0.021508858, 0.0154913515, 0.012066722, 0.008063681, 0.0038490966, 0.0014831498, 8.005798E-4, 0.0016762912, -0.0010069162, -0.0044213533, -0.0037756115, -0.004252419, -0.002855882, -0.001327157, -8.173883E-4, 8.040294E-5, 5.456968E-12, 8.0406666E-5, -3.2910705E-4, -0.001327157, -9.0274215E-4, -0.004252434, -0.0057287216, -0.0044213533, -0.0019834638, 0.0046060085, 0.0017771721, 5.066395E-4, 9.1946125E-4, 0.008063674, 0.015484691, 0.02086246, 0.024926782, 0.027548075, 0.029240131, 0.020597935, 0.027162552, 0.032374382, 0.035971165, 0.023526907,0.0102677345, 0.011802673, 0.013079166, 0.013967276, 0.014570236, 0.014928818, -4.2319298E-4, -2.5081635E-4, -1.5544891E-4, -8.773804E-5, -5.197525E-5, -2.7656555E-5, -1.4305115E-5, -7.1525574E-6, -4.2915344E-6, -1.9073486E-6, -9.536743E-7, -4.7683716E-7, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    # visualize_errors(6.0, 100, siluPWLSigmoid20NonUniformSegmentsErrorsMax6, geluPWLSigmoid20NonUniformSegmentsErrorsMax6, make_absolute=True)

    # TODO
    siluPWLSigmoid20NonUniformSegmentsErrorsMax6 = []
    geluPWLSigmoid20NonUniformSegmentsErrorsMax6 = []
    visualize_errors(6.0, 200, siluPWLSigmoid20NonUniformSegmentsErrorsMax6, geluPWLSigmoid20NonUniformSegmentsErrorsMax6, make_absolute=True)
